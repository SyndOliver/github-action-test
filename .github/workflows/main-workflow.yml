name: Main Workflow - Run GitHub CLI and Save Logs

on: 
  push:
  pull_request:
  workflow_dispatch: 

jobs:
  run-gh-cli:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Run GitHub CLI and save logs
        run: |
          {
            echo "=== START LOG ==="
            gh --version
            echo $GH_TOKEN | gh auth login -h github.com -p https --with-token
            echo "=== END LOG ==="
          } > gh_log.txt 2>&1
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}

      - name: Upload logs as artifact
        uses: actions/upload-artifact@v4
        with:
          name: gh-cli-logs
          path: gh_log.txt