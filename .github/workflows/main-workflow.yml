# main-workflow.yml
name: Main Workflow

on:
  workflow_dispatch:
    inputs:
      simulate:
        description: 'Simulate scenario (fail/timeout/success)'
        required: false
        default: 'success'

jobs:
  job1:
    runs-on: Linux
    timeout-minutes: 60
    outputs:
      status: ${{ steps.set-status.outputs.status }}
    steps:
      - name: Simulate work or failure
        id: main-step
        continue-on-error: true
        run: |
          # Giả lập fail
          if [ "${{ github.event.inputs.simulate }}" == "fail" ]; then
            echo "Simulating failure"
            exit 1
          fi
          
          # Giả lập timeout (chạy lâu)
          if [ "${{ github.event.inputs.simulate }}" == "timeout" ]; then
            echo "Simulating timeout - sleeping for 65 minutes"
            sleep 1200  # Giả lập timeout
          fi
          
          echo "Normal execution"
      
      - name: Set status output
        id: set-status
        if: always()
        run: |
          if [ "${{ steps.main-step.outcome }}" == "failure" ]; then
            echo "status=failed" >> $GITHUB_OUTPUT
          elif [ "${{ steps.main-step.outcome }}" == "cancelled